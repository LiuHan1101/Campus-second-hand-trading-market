<!--components/confirm-popup/confirm-popup.wxml-->
<view class="popup-mask" wx:if="{{show}}" bindtap="onMaskTap" catchtouchmove="preventTouchMove">
  <view class="popup-container" catchtap="onContainerTap">
    <!-- å¼¹çª—å¤´éƒ¨ -->
    <view class="popup-header">
      <text class="popup-title">ç¡®è®¤çº¿ä¸‹äº¤æ˜“ä¿¡æ¯</text>
    </view>
    
    <!-- åå•†æç¤º -->
    <view class="negotiation-tip">
      <text class="tip-icon">ğŸ’¡</text>
      <text class="tip-text">è¯·ä¸å–å®¶åå•†ç¡®è®¤åå†å¡«å†™äº¤æ˜“ä¿¡æ¯</text>
    </view>
    
    <!-- äº¤æ˜“ä¿¡æ¯è¡¨å• -->
    <view class="form-section">
      <!-- äº¤æ˜“æ—¶é—´ -->
      <view class="form-item">
        <text class="form-label">äº¤æ˜“æ—¶é—´</text>
        <picker 
          mode="date" 
          value="{{transactionDate}}" 
          bindchange="onDateChange"
          class="date-picker"
        >
          <view class="picker-display {{transactionDate ? 'has-value' : ''}}">
            {{transactionDate ? transactionDate : 'è¯·é€‰æ‹©æ—¥æœŸ'}}
          </view>
        </picker>
        <picker 
          mode="time" 
          value="{{transactionTime}}" 
          bindchange="onTimeChange"
          class="time-picker"
        >
          <view class="picker-display {{transactionTime ? 'has-value' : ''}}">
            {{transactionTime ? transactionTime : 'è¯·é€‰æ‹©æ—¶é—´'}}
          </view>
        </picker>
      </view>
      
      <!-- äº¤æ˜“åœ°ç‚¹ -->
      <view class="form-item">
        <text class="form-label">äº¤æ˜“åœ°ç‚¹</text>
        <input 
          class="location-input" 
          placeholder="è¯·è¾“å…¥å…·ä½“äº¤æ˜“åœ°ç‚¹ï¼ˆå¦‚ï¼šå›¾ä¹¦é¦†é—¨å£ã€é£Ÿå ‚ä¸‰æ¥¼ç­‰ï¼‰"
          value="{{transactionLocation}}"
          bindinput="onLocationInput"
        />
      </view>
      
      <!-- å¤‡æ³¨ä¿¡æ¯ -->
      <view class="form-item">
        <text class="form-label">å¤‡æ³¨ä¿¡æ¯</text>
        <textarea 
          class="remark-textarea" 
          placeholder="å¯å¡«å†™å…¶ä»–çº¦å®šäº‹é¡¹ï¼ˆé€‰å¡«ï¼‰"
          value="{{transactionRemark}}"
          bindinput="onRemarkInput"
          maxlength="100"
        />
        <text class="word-count">{{transactionRemark.length}}/100</text>
      </view>
    </view>
    
    <!-- å•†å“ä¿¡æ¯ -->
    <view class="product-info">
      <image class="product-image" src="{{productInfo.image}}" mode="aspectFill"></image>
      <view class="product-details">
        <text class="product-title">{{productInfo.title}}</text>
        <view class="price-section">
          <text class="product-price">Â¥{{productInfo.price}}</text>
        </view>
      </view>
    </view>
    
    <!-- æŒ‰é’®åŒºåŸŸ - ä¿®æ”¹ä¸ºä¸‰ä¸ªæŒ‰é’®ï¼šå–æ¶ˆã€ç¡®è®¤(å‘é€æ°”æ³¡)ã€ç¡®è®¤äº¤æ˜“ -->
    <view class="button-group">
      <button class="btn btn-cancel" bindtap="onCancel">å–æ¶ˆ</button>
      <button class="btn btn-bubble {{isFormValid ? '' : 'btn-disabled'}}" 
              bindtap="onConfirmBubble" 
              disabled="{{!isFormValid}}">ç¡®è®¤</button>
      <button class="btn btn-transaction" bindtap="onConfirmTransaction">ç¡®è®¤äº¤æ˜“</button>
    </view>
  </view>
</view>